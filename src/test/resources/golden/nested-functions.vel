include "lang/terminal.vel";

# Вложенная анонимная функция вызываемая сразу (как в test.vel)
func[int] test = func(int a) int {
    func(int a, int b) int {
        a + b;
    }(a, 1);
};

term.println(test(10).str);
term.println(test(20).str);

# Множественные вложенные анонимные функции
func compute(int a, int b) int {
    int sqA = func(int n) int { n * n; }(a);
    int sqB = func(int n) int { n * n; }(b);
    sqA + sqB;
};

term.println(compute(3, 4).str);

# Глубокая вложенность IIFE
func level1(int a) int {
    func(int b) int {
        func(int c) int {
            a + b + c;
        }(3);
    }(2);
};

term.println(level1(1).str);

# Лямбда присваивается переменной и вызывается
func[int] double = func(int x) int { x * 2; };
func[int] triple = func(int x) int { x * 3; };

term.println(double(7).str);
term.println(triple(7).str);
